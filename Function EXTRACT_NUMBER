create or replace FUNCTION EXTRACT_NUMBER (pSTR IN VARCHAR2)
RETURN NUMBER
IS
   vSTR VARCHAR2 (200);
   vRET NUMBER;
BEGIN
   vSTR := UPPER (TRIM (SUBSTR (pSTR, 1, 200)));
   vSTR := TRANSLATE (vSTR, ',.;', ',,,');
   vSTR := TRANSLATE (vSTR, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!"§$%&/()=:@€+#-_'
                          , 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');
   vSTR := REPLACE   (vSTR, 'A', '');
   vRET := TO_NUMBER (vSTR);
   RETURN (vRET);
EXCEPTION
   WHEN OTHERS THEN
      RETURN (-1);
END EXTRACT_NUMBER;
